<script>
  import { gsap } from "gsap";
  const menuIcon = document.getElementById("menuIcon");
  const xIcon = document.getElementById("xIcon");
  const sidebar = document.getElementById("sidebar");
  const sidebarImages = document.getElementById("sidebarImages");
  const iconImages = document.getElementById("iconImages");
  const language = document.getElementById("language");
  const arrowLanguage = document.getElementById("arrowLanguage");
  const charactersList = document.getElementById("charactersList");
  const listLanguages = document.getElementById("listLanguages");
  const motion = document.getElementById("motion");
  const motionContainer = document.getElementById("motionContainer");
  const motionArrow = document.getElementById("motionArrow");
  const movementInputContainer = document.getElementById("movementInputContainer");
  const movementInputBall = document.getElementById("movementInputBall");
  let openLanguage = false;
  let openMotion = false;
  let fullMovementActive = true;

  const sidebarMovementValue = 768 > window.innerWidth ? "-91.6667%" : "-50%";

  const characters = ["sailormoon", "mikasa", "frieren", "hinata", "rukia", "zero", "matoko", "nao"]
  let anyActive = "";
  characters.forEach((character)=>{
    let current = document.getElementById(character);
    let currentButton = document.getElementById(character+"Button")
    
    const movementC = gsap.to(current, {
                x: -400,
                duration: 50,
                yoyo: true,
                repeat: -1,
                ease: "Power1.inOut"
              })

    currentButton?.addEventListener("mouseenter",()=>{
        anyActive = character;
        gsap.to(current, {
            opacity: 1,
            zIndex: 20,
            duration: 0.3,
            })
        movementC.play();
        gsap.to(iconImages,{
            opacity: 0,        
            })
        
    })

    currentButton?.addEventListener("mouseleave",()=>{
        anyActive = "";
        gsap.to(current, {
            opacity: 0,
            zIndex: 10,
            duration: 0.3,
            onComplete: ()=>{
              movementC.restart();
              movementC.pause();
                if(anyActive === ""){
                    gsap.to(iconImages,{
                        opacity: 1,
                        zIndex: 0,
                        delay: .2
                    })
                }
            }
        })
    })
  })

  movementInputContainer?.addEventListener("click", ()=>{
      gsap.to(movementInputBall,{
        x: fullMovementActive ? 22 : 0,
        duration: .5,
        ease: "power3.out"
      })
      fullMovementActive = !fullMovementActive;
  })

  menuIcon?.addEventListener("click", () => {
    gsap.to(menuIcon, {
      opacity: 0,
      scale: 0.5,
      duration: 0.3,
      zIndex: 20,
      onComplete: () => {
        gsap.to(xIcon, {
          opacity: 1,
          scale: 1,
          zIndex: 30,
        });
        gsap.to(sidebar, {
          right: 0,
        });
        gsap.to(sidebarImages, {
          opacity: 1,
          display: "block",
          delay: 0.5,
        });
      },
    });
  });

  xIcon?.addEventListener("click", () => {
    gsap.to(xIcon, {
      opacity: 0,
      scale: 0.5,
      duration: 0.3,
      zIndex: 20,
      onComplete: () => {
        gsap.to(menuIcon, {
          opacity: 1,
          scale: 1,
          zIndex: 30,
          delay: 0.2,
        });
        gsap.to(sidebar, {
          right: sidebarMovementValue,
          delay: 0.2,
        });
        gsap.to(sidebarImages, {
          opacity: 0,
          display: "hidden",
        });
      },
    });
  });

  motion?.addEventListener("click",()=>{
      gsap.to(motionContainer,{
        opacity: openMotion ? 0 : 1,
        zIndex: openMotion ? -10 : 30,
        duration: 0.2
      })
      gsap.to(motionArrow,{
        rotate: openMotion ? (window.innerWidth > 768 ? 180 : 360) : (window.innerWidth > 768 ? 360 : 180),
        duration: 1
      })
      gsap.to(charactersList,{
        opacity: openMotion ? 1 : 0,
        duration: 0.2
      })
      gsap.to(language,{
        zIndex: openMotion ? 40 : 20
      })
      openMotion = !openMotion
  })

  language?.addEventListener("click", ()=>{
      gsap.to(arrowLanguage, {
        rotate: openLanguage ? (window.innerWidth > 768 ? 180 : 360) : (window.innerWidth > 768 ? 360 : 180),
        duration: 1
      })
      gsap.to(listLanguages,{
        opacity: openLanguage ? 0 : 1,
        zIndex: openLanguage ? -10 : 30,
        duration: 0.2
      })
      gsap.to(charactersList, {
          opacity: openLanguage ? 1 : 0,
          zIndex: openLanguage ? 30 : -10,
          duration: 0.2
        })
        gsap.to(motion,{
        zIndex: openLanguage ? 40 : 20
        })
      openLanguage = !openLanguage;
  })
</script>

<div class="fixed top-0 w-full m-auto">
  <div class="flex relative content-between w-11/12 m-auto mt-5 pt-3
      md:mt-8
      xl:mt-15
  ">
    <img src="/cosplayer.png" class="w-10" />
    <img
      src="/menu.svg"
      id="menuIcon"
      class="menu_icon z-30 cursor-pointer absolute right-0 top-3 w-10
        md:right-8
      "
    />
    <img
      src="/xmark.svg"
      id="xIcon"
      class="menu_icon z-20 cursor-pointer absolute right-0 top-3 opacity-0 bg-gray-800/40 rounded-full p-2 w-10
          md:right-8
      "
    />
  </div>
  <div
    id="sidebarImages"
    class="custom_gradient w-1/12 bg-black absolute h-[100vh] top-0 opacity-0 hidden
        md:w-6/12
    "
  >
    <ul class="h-full w-full relative overflow-hidden">
      <li class="justify-center items-center w-full h-full hidden
        md:flex
      "><img id="iconImages" class="z-0" src="cosplayer.png" /></li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem]" class="absolute w-[200%] object-cover top-0 left-[-5rem]">
        <img
          id="sailormoon"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/sailormoon.jpeg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem]">
        <img
          id="mikasa"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/mikasa.jpeg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem]">
        <img
          id="frieren"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/frieren.jpg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem]">
        <img
          id="hinata"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/hinata.jpg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem]">
        <img
          id="rukia"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/rukia.jpg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem] -translate-x-3/12">
        <img
          id="zero"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/zero.jpg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem] -translate-x-3/12">
        <img
          id="matoko"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/matoko.jpg"
        />
      </li>
      <li class="absolute w-[200%] object-cover top-0 left-[-5rem]">
        <img
          id="nao"
          class="relative h-[100vh] w-[100vw] opacity-0"
          src="/characters/nao.jpg"
        />
      </li>
    </ul>
  </div>
  <div
    id="sidebar"
    class="absolute h-[100vh] pl-5 bg-[rgb(42,0,48)] w-11/12 right-[-91.6667%] top-0 pt-10 flex flex-col-reverse justify-between pb-10
        md:w-6/12 md:right-[-50%] md:flex-col md:pl-15 md:pt-0
    "
  >
    <ul class="flex content-center mt-18 text-sm text-white font-semibold border-t-2 border-pink-300 py-5 overflow-scroll -ml-5 pl-5
        sm:text-md
        md:border-none md:pl-0 md:overflow-auto
        lg:text-lg
        xl:text-xl
    ">
      <li class="cursor-pointer py-1 px-3 item_active
          md:py-3 md:px-5
      ">Characters.</li>
      <li class="cursor-pointer py-1 px-3
          md:py-3 md:px-5
      ">Pages.</li>
      <li class="cursor-pointer py-1 px-3
          md:py-3 md:px-5
      ">Trailers.</li>
      <li class="cursor-pointer py-1 px-3
          md:py-3 md:px-5
      ">Download.</li>
    </ul>
    <ul id="charactersList"
      class="font-bold flex flex-col text-xl items-start text-white uppercase gap-2 tracking-tighter -translate-y-1/3
          sm:textl-xl
          md:text-2xl  md:translate-y-0
          lg:text-4xl
          xl:text-6xl
      "
    >
    <li class="text-gray-700 md:hidden"> Characters. </li>
      <li id="sailormoonButton" class="cursor-pointer hover:text-pink-400 duration-200">
        Sailon Moon
      </li>
      <li id="mikasaButton" class="cursor-pointer hover:text-pink-400 duration-200">
        Mikasa Ackerman
      </li>
      <li id="frierenButton" class="cursor-pointer hover:text-pink-400 duration-200">Frieren</li>
      <li id="hinataButton" class="cursor-pointer hover:text-pink-400 duration-200">
        Hinata Hyuga
      </li>
      <li id="rukiaButton" class="cursor-pointer hover:text-pink-400 duration-200">
        Rukia Kuchiki
      </li>
      <li id="zeroButton" class="cursor-pointer hover:text-pink-400 duration-200">Zero Two</li>
      <li id="matokoButton" class="cursor-pointer hover:text-pink-400 duration-200">
        Motoko Kusanagi
      </li>
      <li id="naoButton" class="cursor-pointer hover:text-pink-400 duration-200">
        Nao Tomori
      </li>
    </ul>
    <ul class="flex w-11/12 text-sm gap-2
        md:text-xl md:justify-between
    ">
      <li class="flex gap-2 text-white font-bold items-center cursor-pointer z-40" id="language">
        <img class="w-5"
          src="/language.svg" /> English 
          <img
          class="w-5 md:rotate-180"
          src="/arrow.svg"
          id="arrowLanguage"
        />
      </li>
      <div id="listLanguages" class="absolute -z-10 h-full w-full top-0 right-0 bg-[rgba(42,0,48,.8)] opacity-0"> 
          <ul class="relative top-1/6 ml-15 flex flex-col gap-5 text-sm items-baseline text-white font-bold
              md:text-2xl
          ">
            <li> <input type="radio"> English</li>
            <li> <input type="radio"> Deutsch</li>
            <li> <input type="radio"> Español</li>
            <li> <input type="radio"> Español de lationoamerica</li>
            <li> <input type="radio"> Français</li>
            <li> <input type="radio"> Italiano</li>
            <li> <input type="radio"> 日本語</li>
            <li> <input type="radio"> 한국어</li>
            <li> <input type="radio"> Polski</li>
            <li> <input type="radio"> Português do Brasil</li>
            <li> <input type="radio"> Русский</li>
            <li> <input type="radio"> 繁體中文</li>
            <li> <input type="radio"> 简体中文</li>
          </ul>
        </div>
      <li class="flex gap-2 text-white font-bold items-center cursor-pointer z-40" id="motion">
        Motion <img class="w-5 md:rotate-180" src="/arrow.svg" id="motionArrow"/>
      </li>
      <div class="absolute -z-10 h-full w-full top-0 right-0 bg-[rgba(42,0,48,.8)] opacity-0" id="motionContainer">
        <div class="relative top-3/12 left-0 right-0 mx-auto w-2/3 bg-purple-950 px-6 py-10
            md:top-5/12
        ">
          <input type="checkbox" class="sr-only" id="movementInput"> 
          <label id="movementInputContainer" for="movementInput" class="absolute top-10 right-10 w-14 h-8 bg-gray-800 border-2 rounded-2xl flex items-center cursor-pointer"> <div id="movementInputBall" class="bg-black size-6 rounded-full ml-0.5"> </div> </label>
          <h2 class="font-semibold text-lg text-white"> Reducir movimiento </h2>
          <p class="text-lg text-shadow-fuchsia-500 mt-2"> Reduce al mínimo las animaciones, los efectos dinámicos y el movimiento visual para aumentar el rendimiento. </p>
        </div> 
      </div>
    </ul>
  </div>
</div>

<style>
  .custom_gradient {
    background: #410541;
    background: radial-gradient(
      circle,
      rgba(65, 5, 65, 1) 13%,
      rgba(50, 0, 50, 1) 40%,
      rgba(42, 0, 48, 1) 100%
    );
  }

  .custom_background{
    background: #2A0030;
background: linear-gradient(90deg, rgba(42, 0, 48, 1) 0%, rgba(50, 0, 50, 1) 71%, rgba(42, 0, 48, 0) 100%);
  }

  .item_active {
    background-color: white;
    color: black;
    border-radius: 2rem;
  }
</style>

